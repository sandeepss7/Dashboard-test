<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Applify — Dashboard Demo</title>

  <!-- Bootstrap icons (used in markup) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    :root{
      --bg: #f4f6fb;
      --card: #fff;
      --muted: #9aa0b4;
      --accent: #805ad5;
      --light: #eef1fb;
    }
    html,body{ height:100%; margin:0; font-family: Inter, system-ui, Arial; background: linear-gradient(180deg,#f6f8fc,#eef2f9); color:#222; }
    .d-flex{ display:flex; }
    .flex-grow-1{ flex:1; }
    .gap-3{ gap:1rem; }
    .p-4{ padding:1.25rem; }
    /* page layout */
    .app-wrap{ display:flex; height:100vh; gap:1rem; align-items:stretch; }

    /* SIDEBAR */
    .app-sidebar{
      width: 82px;
      background: #fff;
      border-radius: 12px;
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
      box-shadow: 0 6px 18px rgba(15,20,30,0.04);
      transition: width .22s ease;
      position:relative;
    }
    .app-sidebar.collapsed{ width:64px; }
    .sidebar-top{ width:100%; display:flex; justify-content:space-between; align-items:center; padding:6px 4px; }
    .brand-mark{ width:36px; height:36px; border-radius:8px; background:linear-gradient(135deg,#6f3cf1,#8c61ff); color:#fff; display:flex; align-items:center; justify-content:center; font-weight:700; }
    .brand-text{ display:none; font-weight:700; color:#333; margin-left:8px; }
    .collapse-btn{ border-radius:8px; padding:6px; border:0; background:transparent; }
    .app-sidebar .nav-col{ width:100%; margin-top:8px; position:relative; display:flex; flex-direction:column; gap:6px; align-items:center; }
    .app-sidebar .nav-item{
      width:100%;
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 8px;
      color:#697182;
      border-radius:10px;
      text-decoration:none;
      cursor:pointer;
      justify-content:center;
    }
    .app-sidebar .nav-item i{ font-size:18px; }
    .app-sidebar .nav-item span{ display:none; }
    .app-sidebar .nav-item.active{ background:linear-gradient(90deg,#f3f0ff,#fff); color:var(--accent); box-shadow: 0 6px 14px rgba(93,64,255,0.06); }
    .app-sidebar .edge-pill{
      position:absolute; left:8px; width:6px; border-radius:6px; background:linear-gradient(180deg,#6f3cf1,#5a40ff); opacity:0; transition: top .2s ease, height .2s ease, opacity .2s ease;
    }
    .upgrade-card{ margin-top:auto; display:block; width:100%; border-radius:8px; overflow:hidden; }
    .upgrade-card img{ width:100%; display:block; }

    /* MAIN AREA */
    .main-area{
      background:transparent;
      display:flex;
      flex-direction:column;
      gap:1rem;
      min-width:0;
    }
    .main-area h3{ margin:0; font-size:1.125rem; color:#333; }

    /* content cards */
    .card{
      background:var(--card);
      border-radius:12px;
      padding:1rem;
      box-shadow: 0 6px 18px rgba(15,20,30,0.03);
    }

    /* stat cards row */
    .stat-row{ display:flex; gap:1rem; }
    .stat-card{ display:flex; justify-content:space-between; gap:8px; align-items:center; padding:12px; border-radius:12px; background:var(--card); min-height:100px; }
    .stat-card .left{ flex:1; }
    .stat-card .label{ color:var(--muted); font-weight:600; font-size:0.9rem; }
    .stat-card .big{ font-size:1.4rem; margin-top:6px; }
    .chart-wrap{ width:96px; height:96px; position:relative; display:flex; align-items:center; justify-content:center; }
    .percent-badge{ position:absolute; left:6px; bottom:6px; text-align:center; font-weight:700; color:#222; }
    canvas{ display:block; }

    /* charts grid */
    .charts-grid{ display:flex; gap:1rem; }
    .charts-grid .left-col{ flex:1; }
    .charts-grid .right-col{ width:320px; }

    .chart-container{ height:300px; position:relative; padding:6px; }
    .legend-container{ display:flex; gap:1rem; margin-top:0.75rem; align-items:center; }

    .legend-dot{ width:12px; height:12px; border-radius:6px; display:inline-block; margin-right:6px; }

    /* right profile panel */
    .page{ display:flex; gap:1rem; align-items:flex-start; }
    .left{ flex:1; }
    .profile-panel{
      width:320px;
      border-radius:12px;
      background:var(--card);
      box-shadow: 0 6px 18px rgba(15,20,30,0.04);
      padding:12px;
      transition: width .25s ease, transform .25s ease;
    }
    .profile-panel.collapsed{ width:72px; overflow:hidden; }
    .profile-top{ display:flex; justify-content:space-between; align-items:center; }
    .profile-info{ display:flex; gap:10px; align-items:center; }
    .profile-avatar img{ width:64px; height:64px; border-radius:50%; object-fit:cover; }
    .profile-name .name{ font-weight:700; }
    .profile-toggle{ border-radius:8px; padding:6px; background:transparent; border:0; }

    /* job cards */
    .job-card{ display:flex; gap:10px; align-items:center; padding:10px; border-radius:12px; margin-bottom:8px; }
    .job-card.orange{ background: linear-gradient(90deg,#ffb49a,#ff8a65); color:#fff; }
    .job-card.purple{ background: linear-gradient(90deg,#7c4dff,#5a40ff); color:#fff; }
    .job-card .score{ width:44px; height:44px; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:700; background:rgba(255,255,255,0.12);}
    .job-card .info .title{ font-weight:700; font-size:0.95rem; }
    .job-card .meta{ font-size:0.85rem; opacity:0.9; }

    /* reminders */
    .reminders{ list-style:none; padding:0; margin:0; }
    .rem-item{ display:flex; gap:8px; align-items:center; padding:8px 6px; border-radius:8px; }
    .rem-dot{ width:36px; height:36px; border-radius:8px; background:#f0f3ff; display:flex; align-items:center; justify-content:center; color:#6f3cf1; }

    /* responsive */
    @media (max-width: 980px){
      .app-wrap{ flex-direction:column; height:auto; padding:12px; }
      .app-sidebar{ width:72px; align-self:flex-start; }
      .profile-panel{ width:100%; }
    }
  </style>
</head>
<body>
  <div class="app-wrap">
    <!-- SIDEBAR -->
    <aside class="app-sidebar shadow-sm" id="sidebar" role="navigation" aria-label="Main sidebar">
      <div class="sidebar-top">
        <div class="logo-wrap" style="display:flex;align-items:center;gap:8px;">
          <div class="brand-mark" aria-hidden="true">A</div>
          <div class="brand-text">Applify</div>
        </div>
        <button id="toggleBtn" class="collapse-btn" aria-label="Toggle sidebar">
          <i class="bi bi-list"></i>
        </button>
      </div>

      <nav class="nav-col position-relative" role="menu" aria-label="Main navigation">
        <a href="#" class="nav-item active" data-tab="dashboard" role="menuitem" tabindex="0">
          <i class="bi bi-grid-3x3-gap-fill"></i><span>Dashboard</span>
        </a>
        <a href="#" class="nav-item" data-tab="jobs" role="menuitem" tabindex="0">
          <i class="bi bi-briefcase"></i><span>Jobs</span>
        </a>
        <a href="#" class="nav-item" data-tab="schedule" role="menuitem" tabindex="0">
          <i class="bi bi-calendar-event"></i><span>Schedule</span>
        </a>
        <a href="#" class="nav-item" data-tab="documents" role="menuitem" tabindex="0">
          <i class="bi bi-folder2-open"></i><span>Documents</span>
        </a>
        <a href="#" class="nav-item" data-tab="statistics" role="menuitem" tabindex="0">
          <i class="bi bi-bar-chart"></i><span>Statistics</span>
        </a>
        <a href="#" class="nav-item" data-tab="community" role="menuitem" tabindex="0">
          <i class="bi bi-people"></i><span>Community</span>
        </a>
        <a href="#" class="nav-item" data-tab="messages" role="menuitem" tabindex="0">
          <i class="bi bi-chat-dots"></i><span>Messages</span>
        </a>
        <a href="#" class="nav-item" data-tab="logout" role="menuitem" tabindex="0">
          <i class="bi bi-box-arrow-right"></i><span>Logout</span>
        </a>

        <div class="edge-pill d-none d-md-block" aria-hidden="true"></div>
      </nav>

      <a class="upgrade-card" href="#" aria-hidden="true">
        <img src="https://via.placeholder.com/72x90.png?text=Upgrade" alt="upgrade">
      </a>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-area flex-grow-1 p-4" role="main">
      <div class="d-flex align-items-start gap-3 mb-3">
        <h3 id="panelTitle">Dashboard</h3>
      </div>

      <!-- Statistic small cards -->
      <div class="stat-row" style="margin-bottom:12px;">
        <div class="stat-card card" id="card-1" data-initial="74" style="flex:1;">
          <div class="left">
            <div class="label">Total Applications</div>
            <h2 class="big" id="big-1">5,672</h2>
            <div class="sub" style="display:flex;align-items:center;gap:8px;color:var(--muted)"><div class="dot" style="width:10px;height:10px;border-radius:4px;background:#6f3cf1"></div><div>+14% Inc</div></div>
          </div>
          <div class="chart-wrap">
            <canvas id="chart1" width="96" height="96" aria-label="Total Applications progress" role="img"></canvas>
            <div class="percent-badge">
              <div id="pLabel1">+74%</div>
              <small id="pSmall1" style="display:block;background:linear-gradient(135deg,#6f3cf1,#8c61ff);padding:2px 6px;border-radius:6px;color:#fff;font-weight:700;">+74%</small>
            </div>
          </div>
        </div>

        <div class="stat-card card" id="card-2" data-initial="58" style="flex:1;">
          <div class="left">
            <div class="label">Active Users</div>
            <h2 class="big" id="big-2">3,210</h2>
            <div class="sub" style="display:flex;align-items:center;gap:8px;color:var(--muted)"><div class="dot" style="width:10px;height:10px;border-radius:4px;background:#17c3a2"></div><div>+8% Inc</div></div>
          </div>
          <div class="chart-wrap">
            <canvas id="chart2" width="96" height="96" aria-label="Active Users progress" role="img"></canvas>
            <div class="percent-badge">
              <div id="pLabel2">+58%</div>
              <small id="pSmall2" style="display:block;background:linear-gradient(135deg,#17c3a2,#3ae6c8);padding:2px 6px;border-radius:6px;color:#fff;font-weight:700;">+58%</small>
            </div>
          </div>
        </div>

        <div class="stat-card card" id="card-3" data-initial="45" style="flex:1;">
          <div class="left">
            <div class="label">Completed Tasks</div>
            <h2 class="big" id="big-3">1,203</h2>
            <div class="sub" style="display:flex;align-items:center;gap:8px;color:var(--muted)"><div class="dot" style="width:10px;height:10px;border-radius:4px;background:#ff8a65"></div><div>+5% Inc</div></div>
          </div>
          <div class="chart-wrap">
            <canvas id="chart3" width="96" height="96" aria-label="Completed Tasks progress" role="img"></canvas>
            <div class="percent-badge">
              <div id="pLabel3">+45%</div>
              <small id="pSmall3" style="display:block;background:linear-gradient(135deg,#ff8a65,#ff6b6b);padding:2px 6px;border-radius:6px;color:#fff;font-weight:700;">+45%</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Charts grid -->
      <div class="charts-grid">
        <div class="left-col" style="flex:1;">
          <div class="card">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
              <h4 style="margin:0;">Statistics of Active Applications</h4>
              <div style="color:var(--muted);display:flex;align-items:center;gap:8px;">Week <button class="btn" style="padding:6px;border-radius:8px;background:#f2f3fb;border:1px solid #eee;">Week</button></div>
            </div>
            <div class="chart-container">
              <canvas id="weeklyChart"></canvas>
            </div>
            <div class="legend-container">
              <div style="display:flex;align-items:center;gap:6px;"><span class="legend-dot" style="background:#805ad5"></span><span style="color:var(--muted)">Applications</span></div>
              <div style="display:flex;align-items:center;gap:6px;"><span class="legend-dot" style="background:#ecc94b"></span><span style="color:var(--muted)">Shortlisted</span></div>
              <div style="display:flex;align-items:center;gap:6px;"><span class="legend-dot" style="background:#f56565"></span><span style="color:var(--muted)">Rejected</span></div>
              <div style="display:flex;align-items:center;gap:6px;"><span class="legend-dot" style="background:#c3bef0"></span><span style="color:var(--muted)">On Hold</span></div>
            </div>
          </div>

          <!-- Applications Received Time -->
          <div class="card" style="margin-top:12px;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
              <h4 style="margin:0;">Applications Received Time</h4>
              <div style="color:var(--muted);display:flex;align-items:center;gap:8px;">Today <button class="btn" style="padding:6px;border-radius:8px;background:#f2f3fb;border:1px solid #eee;">Today</button></div>
            </div>
            <div class="chart-container" style="height:200px;">
              <canvas id="timelineChart"></canvas>
            </div>
          </div>
        </div>

        <!-- right column short stats -->
        <div class="right-col">
          <div class="card">
            <h4 style="margin-top:0;margin-bottom:8px;">Acquisitions</h4>
            <div style="display:flex;flex-direction:column;gap:12px;">
              <div style="display:flex;align-items:center;justify-content:space-between;">
                <div style="display:flex;align-items:center;gap:12px;">
                  <span style="width:12px;height:12px;border-radius:6px;background:#805ad5;display:inline-block;"></span>
                  <div>Applications</div>
                </div>
                <div>80%</div>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;">
                <div style="display:flex;align-items:center;gap:12px;">
                  <span style="width:12px;height:12px;border-radius:6px;background:#ecc94b;display:inline-block;"></span>
                  <div>Shortlisted</div>
                </div>
                <div>55%</div>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;">
                <div style="display:flex;align-items:center;gap:12px;">
                  <span style="width:12px;height:12px;border-radius:6px;background:#f56565;display:inline-block;"></span>
                  <div>Rejected</div>
                </div>
                <div>47%</div>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;">
                <div style="display:flex;align-items:center;gap:12px;">
                  <span style="width:12px;height:12px;border-radius:6px;background:#c3bef0;display:inline-block;"></span>
                  <div>On Hold</div>
                </div>
                <div>35%</div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </main>

    <!-- RIGHT PROFILE PANEL -->
    <aside class="profile-panel" id="profilePanel" aria-label="Profile panel">
      <div class="profile-top">
        <div class="profile-info">
          <div class="profile-avatar" aria-hidden="true">
            <img src="https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=400&auto=format&fit=crop&ixlib=rb-4.0.3&s=49eee9d6ac1c3b9d3b5a9c1b1356b9e8" alt="avatar">
          </div>
          <div class="profile-name">
            <div class="name">Candace Jules</div>
            <div class="role" style="font-size:0.9rem;color:var(--muted)">Director of Recruiting</div>
            <div class="loc" style="font-size:0.85rem;color:var(--muted)"><i class="bi bi-geo-alt-fill"></i> New York, US</div>
          </div>
        </div>

        <button class="profile-toggle" id="profileToggle" aria-pressed="false" aria-label="Collapse profile">
          <i class="bi bi-chevron-right"></i>
        </button>
      </div>

      <div class="profile-body" id="profileBody" style="margin-top:12px;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
          <div class="section-title">Jobs Posted</div>
          <button class="btn" style="background:var(--accent);color:#fff;border-radius:8px;padding:8px 10px;">+ Add</button>
        </div>

        <div class="job-card orange" role="group" aria-label="job sr android">
          <div class="score">95</div>
          <div class="info">
            <div class="title">Sr. Android Developer</div>
            <div class="meta">Total Applications</div>
          </div>
          <div class="switch"><input type="checkbox" checked aria-label="toggle job 1"></div>
        </div>

        <div class="job-card purple" role="group" aria-label="job uxui">
          <div class="score">80</div>
          <div class="info">
            <div class="title">UX/UI Designer</div>
            <div class="meta">Total Applications</div>
          </div>
          <div class="switch"><input type="checkbox" checked aria-label="toggle job 2"></div>
        </div>

        <div class="section-title" style="margin-top:12px;margin-bottom:8px;">Reminders</div>
        <ul class="reminders" aria-live="polite">
          <li class="rem-item">
            <div class="rem-dot"><i class="bi bi-clock"></i></div>
            <div class="rem-text">Your subscription expires <strong>Today</strong>. <a href="#">Renew Now</a></div>
            <div class="rem-time">6:30 PM</div>
          </li>
          <li class="rem-item">
            <div class="rem-dot" style="background:rgba(255,210,95,0.07);color:#d97706"><i class="bi bi-envelope"></i></div>
            <div class="rem-text">There are <strong>4 new applications</strong> for iOS Developer Post.</div>
            <div class="rem-time">5:30 PM</div>
          </li>
          <li class="rem-item">
            <div class="rem-dot" style="background:rgba(255,80,80,0.06);color:#ff4d4f"><i class="bi bi-x-circle"></i></div>
            <div class="rem-text">You have closed the job post for Design Lead.</div>
            <div class="rem-time">5:00 PM</div>
          </li>
        </ul>
      </div>
    </aside>
  </div>

  <!-- Chart.js (must be loaded before chart init script) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- Combined external JS (sidebar, profile, doughnuts, charts, interactions) -->
  <script>
    /* ---------------- Sidebar & Profile logic (DOM-safe) ---------------- */
    document.addEventListener('DOMContentLoaded', () => {
      // Sidebar
      (function sidebarInit(){
        const sidebar = document.getElementById('sidebar');
        const toggleBtn = document.getElementById('toggleBtn');
        const navCol = document.querySelector('.app-sidebar .nav-col');
        const navItems = Array.from(document.querySelectorAll('.app-sidebar .nav-item'));
        let edgePill = document.querySelector('.app-sidebar .edge-pill');
        const panelTitle = document.getElementById('panelTitle');

        if (!navCol) return;
        if (!edgePill) {
          edgePill = document.createElement('div');
          edgePill.className = 'edge-pill d-none d-md-block';
          navCol.appendChild(edgePill);
        }

        function positionEdgePillFor(item) {
          if (!item || !edgePill) return;
          const navRect = navCol.getBoundingClientRect();
          const itemRect = item.getBoundingClientRect();
          const topWithin = itemRect.top - navRect.top;
          edgePill.style.top = `${topWithin}px`;
          edgePill.style.height = `${itemRect.height}px`;
          edgePill.style.opacity = '1';
        }

        function setActiveItem(item, { switchPanel = true } = {}) {
          if (!item) return;
          navItems.forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          if (sidebar && sidebar.classList.contains('collapsed')) {
            edgePill.style.opacity = '0';
          } else positionEdgePillFor(item);

          if (switchPanel) {
            const tabName = item.dataset.tab;
            if (tabName) {
              const panels = document.querySelectorAll('.tab-panel');
              panels.forEach(p => {
                p.style.display = (p.dataset.panel === tabName) ? '' : 'none';
              });
              if (panelTitle) panelTitle.textContent = (item.innerText || tabName).trim();
            }
          }
        }

        const initial = navItems.find(i => i.classList.contains('active')) || navItems[0];
        setTimeout(() => setActiveItem(initial, { switchPanel: true }), 30);

        navItems.forEach(item => {
          item.addEventListener('click', e => { e.preventDefault(); setActiveItem(item); });
          item.addEventListener('keydown', e => { if (e.key==='Enter' || e.key===' ') { e.preventDefault(); item.click(); } });
        });

        if (toggleBtn) {
          toggleBtn.addEventListener('click', ()=> {
            sidebar.classList.toggle('collapsed');
            const icon = toggleBtn.querySelector('i'); if (icon) icon.classList.toggle('rotated');
            if (sidebar.classList.contains('collapsed')) edgePill.style.opacity = '0';
            else {
              const activeNow = document.querySelector('.app-sidebar .nav-item.active') || navItems[0];
              setTimeout(()=> positionEdgePillFor(activeNow), 200);
            }
          });
        }

        // persist active
        const STORAGE_KEY = 'applify_sidebar_active_tab';
        try {
          const stored = localStorage.getItem(STORAGE_KEY);
          if (stored) {
            const storedItem = navItems.find(i => i.dataset.tab === stored);
            if (storedItem) setActiveItem(storedItem, { switchPanel: true });
          }
          navItems.forEach(i => i.addEventListener('click', ()=> { if (i.dataset.tab) localStorage.setItem(STORAGE_KEY, i.dataset.tab); }));
        } catch(e) {}
        window.addEventListener('resize', ()=> {
          const activeNow = document.querySelector('.app-sidebar .nav-item.active') || navItems[0];
          if (!sidebar.classList.contains('collapsed')) positionEdgePillFor(activeNow);
        });
      })();

      // Profile panel toggle
      (function profileInit(){
        const profilePanel = document.getElementById('profilePanel');
        const profileToggle = document.getElementById('profileToggle');
        const ICON = profileToggle?.querySelector('i');
        const STORAGE_KEY = 'profile_panel_collapsed';
        try {
          if (localStorage.getItem(STORAGE_KEY) === '1') {
            profilePanel && profilePanel.classList.add('collapsed');
            if (ICON) ICON.classList.add('rotated');
            profileToggle && profileToggle.setAttribute('aria-pressed','true');
          } else profileToggle && profileToggle.setAttribute('aria-pressed','false');
        } catch(e){}

        profileToggle?.addEventListener('click', (e) => {
          e.preventDefault();
          const collapsed = profilePanel.classList.toggle('collapsed');
          ICON && ICON.classList.toggle('rotated', collapsed);
          profileToggle.setAttribute('aria-pressed', String(!!collapsed));
          try { localStorage.setItem(STORAGE_KEY, collapsed ? '1' : '0'); } catch(e){}
        });
      })();
    }); // DOMContentLoaded sidebar/profile
  </script>

  <!-- Doughnuts + Charts + Animations -->
  <script>
    // doughnut animations run on load (safe)
    window.addEventListener('load', () => {
      // small reusable tween
      function tweenNumber(from, to, duration, onTick, onComplete){
        const start = performance.now();
        function frame(now){
          const t = Math.min(1, (now - start) / duration);
          const eased = t < 0.5 ? 4*t*t*t : 1 - Math.pow(-2*t + 2, 3)/2;
          const val = from + (to - from) * eased;
          onTick(val);
          if (t < 1) requestAnimationFrame(frame); else onComplete && onComplete();
        }
        requestAnimationFrame(frame);
      }

      function createDoughnut(canvas, colorStops, initialPercent) {
        const ctx = canvas.getContext('2d');
        const grad = ctx.createLinearGradient(0, 0, canvas.width || 96, 0);
        grad.addColorStop(0, colorStops[0]); grad.addColorStop(1, colorStops[1]);

        const data = { datasets: [{ data: [initialPercent, 100 - initialPercent], backgroundColor: [grad, '#eef0f6'], borderWidth: 0 }] };
        const chart = new Chart(ctx, {
          type: 'doughnut', data,
          options: {
            responsive:false, maintainAspectRatio:false, cutout:'76%', rotation:-90, circumference:360,
            animation:{ duration:1100, easing:'cubicBezier(.22,.9,.18,1)' },
            plugins:{ tooltip:{enabled:false}, legend:{display:false} }
          }
        });
        return chart;
      }

      const cardsCfg = [
        { id:'chart1', colorStops:['#6f3cf1','#8c61ff'], initial: parseInt(document.getElementById('card-1')?.dataset.initial || 74) },
        { id:'chart2', colorStops:['#17c3a2','#3ae6c8'], initial: parseInt(document.getElementById('card-2')?.dataset.initial || 58) },
        { id:'chart3', colorStops:['#ff8a65','#ff6b6b'], initial: parseInt(document.getElementById('card-3')?.dataset.initial || 45) }
      ];

      const instances = cardsCfg.map(cfg => {
        const canvas = document.getElementById(cfg.id);
        if (!canvas) return null;
        canvas.width = 96; canvas.height = 96;
        return { chart: createDoughnut(canvas, cfg.colorStops, cfg.initial), cfg };
      }).filter(Boolean);

      function updateCard(instance, newPercent){
        newPercent = Math.max(0, Math.min(100, Math.round(newPercent)));
        const ds = instance.chart.data.datasets[0];
        ds.data[0] = newPercent; ds.data[1] = 100 - newPercent;
        instance.chart.update({ duration:1100, easing:'cubicBezier(.22,.9,.18,1)' });
        const labelEl = document.getElementById(instance.cfg.id.replace('chart','pLabel'));
        const smallEl = document.getElementById(instance.cfg.id.replace('chart','pSmall'));
        const startVal = parseInt((labelEl?.textContent||'0').replace('+','')) || 0;
        tweenNumber(startVal, newPercent, 1100, val => {
          const disp = `${Math.round(val)>=0 ? '+' : ''}${Math.round(val)}%`;
          if (labelEl) labelEl.textContent = disp;
          if (smallEl) smallEl.textContent = disp;
        });
      }

      instances.forEach((inst,i)=> {
        setTimeout(()=> {
          const init = cardsCfg[i].initial;
          const labelEl = document.getElementById(cardsCfg[i].id.replace('chart','pLabel'));
          const smallEl = document.getElementById(cardsCfg[i].id.replace('chart','pSmall'));
          if (labelEl) labelEl.textContent = `+${init}%`;
          if (smallEl) smallEl.textContent = `+${init}%`;
        }, 120 + i*120);
      });

      setInterval(()=> {
        if (instances[0]) updateCard(instances[0], Math.round(50 + Math.random()*50));
        if (instances[1]) updateCard(instances[1], Math.round(30 + Math.random()*55));
        if (instances[2]) updateCard(instances[2], Math.round(20 + Math.random()*60));
      }, 3500);
    }); // load

    // Charts initialization (DOMContentLoaded so canvases exist and Chart.js loaded)
    document.addEventListener('DOMContentLoaded', ()=> {
      // helper
      function getCtx(id){ const el = document.getElementById(id); return el ? el.getContext('2d') : null; }

      // WEEKLY — stacked thin rounded-pill per day
      const weeklyData = {
        labels: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],
        datasets: [
          { label:'On Hold', data:[6,6,6,7,6,6,6], backgroundColor:'#c3bef0', stack:'w' },
          { label:'Rejected', data:[18,20,20,18,20,22,20], backgroundColor:'#f56565', stack:'w' },
          { label:'Shortlisted', data:[22,18,25,18,20,22,20], backgroundColor:'#ecc94b', stack:'w' },
          { label:'Applications', data:[28,26,30,27,33,30,28], backgroundColor:'#805ad5', stack:'w' }
        ]
      };

      const weeklyConfig = {
        type:'bar', data:weeklyData,
        options:{
          responsive:true, maintainAspectRatio:false,
          plugins:{ legend:{display:false}, tooltip:{ callbacks:{ label: ctx => `${ctx.dataset.label}: ${ctx.parsed.y}%` } } },
          scales:{
            x:{ stacked:true, grid:{display:false}, ticks:{color:'#9aa0b4'} },
            y:{ stacked:true, beginAtZero:true, max:100, ticks:{ callback:v=>v+'%', color:'#9aa0b4' }, grid:{color:'#eef2f7', drawBorder:false} }
          },
          elements:{
            bar:{
              borderSkipped:false,
              borderRadius:12,
              barThickness:6,      // change 4..8 for thinner/thicker
              maxBarThickness:12,
              categoryPercentage:0.28,
              barPercentage:1.0
            }
          }
        }
      };

      const weeklyCtx = getCtx('weeklyChart');
      if (weeklyCtx){
        if (window.weeklyChart instanceof Chart) try{ window.weeklyChart.destroy(); }catch(e){}
        window.weeklyChart = new Chart(weeklyCtx, weeklyConfig);
      }

      // TIMELINE (line)
      const timelineData = {
        labels:['8 AM','10 AM','12 PM','2 PM','4 PM','6 PM','8 PM'],
        datasets:[{
          label:'Applications', data:[50,68,72,95,65,85,90],
          borderColor:'#f56565', backgroundColor:'rgba(245,101,101,0.08)', fill:true, tension:0.4, pointRadius:0, borderWidth:2.5
        }]
      };
      const timelineConfig = {
        type:'line', data:timelineData,
        options:{ responsive:true, maintainAspectRatio:false, plugins:{ legend:{display:false}, tooltip:{ callbacks:{ label: ctx => ctx.parsed.y + '% applications' } } }, scales:{ x:{ grid:{display:false}, ticks:{color:'#9aa0b4'} }, y:{ beginAtZero:true, max:100, ticks:{ callback:v=>v+'%', color:'#9aa0b4' }, grid:{color:'#eef2f7'} } } }
      };
      const timelineCtx = getCtx('timelineChart');
      if (timelineCtx){
        if (window.timelineChart instanceof Chart) try{ window.timelineChart.destroy(); }catch(e){}
        window.timelineChart = new Chart(timelineCtx, timelineConfig);
      }

      // GENDER donut
      const genderData = { labels:['Male','Female'], datasets:[{ data:[35,65], backgroundColor:['#805ad5','#f56565'], borderWidth:0, cutout:'75%' }] };
      const genderConfig = { type:'doughnut', data:genderData, options:{ responsive:true, maintainAspectRatio:false, plugins:{ legend:{display:false}, tooltip:{ callbacks:{ label: ctx => ctx.label + ': ' + ctx.parsed + '%' } } } } };
      const genderCtx = getCtx('genderChart');
      if (genderCtx){
        if (window.genderChart instanceof Chart) try{ window.genderChart.destroy(); }catch(e){}
        window.genderChart = new Chart(genderCtx, genderConfig);
      }

      // animate stat bars (simple)
      setTimeout(()=> {
        document.querySelectorAll('.stat-bar').forEach(bar => {
          const width = bar.getAttribute('data-width');
          if (width != null) bar.style.width = width + '%';
        });
      }, 300);

      // selectors
      document.getElementById('weekSelector')?.addEventListener('click', ()=> alert('Week selector clicked'));
      document.getElementById('monthSelector')?.addEventListener('click', ()=> alert('Month selector clicked'));
      document.getElementById('todaySelector')?.addEventListener('click', ()=> alert('Today selector clicked'));
    });
  </script>
</body>
</html>
